{% extends 'base.html' %} {% block content %}
<div class="p-3">
  <div class="container">
    <div class="row mt-3">
      <div class="col mx-auto mb-3">
        <h2>Edit Review</h2>
        <hr />
        <form method="POST">
          {% csrf_token %}
          <div
            id="star-rating"
            style="
              font-size: 1.5rem;
              color: #ddd;
              cursor: pointer;
              user-select: none;
            "
          >
            <input
              type="hidden"
              name="rating"
              id="rating-input"
              value="{{ template_data.review.rating }}"
            />
            {% for i in "12345" %}
            <i
              class="fa fa-star"
              data-value="{{ forloop.counter }}"
              style="color: {% if forloop.counter <= template_data.review.rating %}gold{% else %}#ddd{% endif %};"
            ></i>
            {% endfor %}
          </div>
          <p>
            <label for="comment">Comment:</label>
            <textarea name="comment" required class="form-control" id="comment">
              {{ template_data.review.comment }}
            </textarea>
          </p>
          <div class="text-start">
            <button type="submit" class="btn bg-dark text-white">
              Edit Review
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  (function () {
    const stars = document.querySelectorAll("#star-rating i.fa-star");
    const ratingInput = document.getElementById("rating-input");
    let currentRating = parseInt(ratingInput.value) || 0;

    function setStars(rating) {
      stars.forEach((star, index) => {
        star.style.color = index < rating ? "gold" : "#ddd";
      });
    }

    stars.forEach((star) => {
      star.addEventListener("click", () => {
        currentRating = parseInt(star.getAttribute("data-value"));
        ratingInput.value = currentRating;
        setStars(currentRating);
      });
      star.addEventListener("mouseenter", () => {
        const hoverValue = parseInt(star.getAttribute("data-value"));
        setStars(hoverValue);
      });
    });

    document
      .getElementById("star-rating")
      .addEventListener("mouseleave", () => {
        setStars(currentRating);
      });

    setStars(currentRating);
  })();
</script>
{% endblock content %}
